version: '2.0'

services:

    # Crossbar is the middleware that is used to connect different apps with websockets.
    crossbar:
        build: ./crossbar/
        ports:
            - '7777:7777'

    # This is the PHP backend.
    # It sends and receive events via websockets and Crossbar.io,
    #  this is why it depends on it.
    broadcaster:
        build: ./backend/
        links:
            - crossbar
        external_links:
            - crossbar:crossbar
        environment:
            CROSSBAR_HOST: crossbar

    # This is the node.js frontend application.
    # It only serves static files generated by building JS app.
    # Changing the port here for convenience would have no impact,
    #  as it is just the frontend Sn4k3 application.
    frontend:
        build: ./frontend/
        ports:
            - '8080:8080'
